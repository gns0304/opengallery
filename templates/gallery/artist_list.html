{% extends "common/layout/single_content.html" %}
{% load static %}
{% block title %} - 작가 목록{% endblock %}
{% block page_title %}작가 목록{% endblock %}
{% block page_actions %}{% endblock %}

{% block main %}

<form method="get" class="mb-3" role="search" novalidate>
  <div class="row g-2">
    <div class="col-12">
      <div class="input-group">
        <span class="input-group-text rounded-0">이름</span>
        <input class="form-control" type="text" name="name" value="{{ name }}" placeholder="작가 이름">
      </div>
    </div>

    <div class="col-12 col-md-6">
      <div class="input-group">
        <span class="input-group-text rounded-0">성별</span>
        <select class="form-select" name="gender">
          <option value="">전체</option>
          <option value="M" {% if gender == "M" %}selected{% endif %}>남성</option>
          <option value="F" {% if gender == "F" %}selected{% endif %}>여성</option>
        </select>
      </div>
    </div>

    <div class="col-12 col-md-6">
      <div class="input-group">
        <span class="input-group-text rounded-0">생년월일</span>
        <input class="form-control" type="date" name="birth_date" value="{{ birth_date }}" placeholder="YYYY-MM-DD">
      </div>
    </div>

    <div class="col-12 col-md-6">
      <div class="input-group">
        <span class="input-group-text rounded-0">이메일</span>
        <input class="form-control" type="text" name="email" value="{{ email }}" placeholder="작가 이메일">
      </div>
    </div>

    <div class="col-12 col-md-6">
      <div class="input-group">
        <span class="input-group-text rounded-0">연락처</span>
        <input class="form-control" type="text" name="phone" value="{{ phone }}" placeholder="작가 연락처">
      </div>
    </div>
  </div>

  <div class="d-flex justify-content-end mt-4 mb-4">
    <div class="btn-group" role="group" aria-label="검색 및 초기화">
      <button class="btn btn-dark rounded-0" type="submit">
        <i class="bi bi-search me-1"></i>검색
      </button>
      <a class="btn btn-outline-secondary rounded-0" href="{{ request.path }}">초기화</a>
    </div>
  </div>
</form>

{% if artists %}
  <div class="row g-3">
    {% for a in artists %}
      <div class="col-6 col-md-4 col-lg-3">
        <div class="card h-100 border-1 rounded-0">
          <div class="ratio ratio-4x3 overflow-hidden border-bottom">
            {% if a.latest_artwork_image %}
              <img src="{% get_media_prefix %}{{ a.latest_artwork_image }}" class="w-100 h-100 object-cover" alt="{{ a.name }}">
            {% else %}
              <div class="w-100 h-100 d-flex align-items-center justify-content-center bg-light">
                <span class="text-muted small">이미지 없음</span>
              </div>
            {% endif %}
          </div>
          <div class="card-body p-3">
            <div class="fw-semibold text-truncate" title="{{ a.name }}">{{ a.name }}</div>
            <div class="text-muted small mt-1">
              {% if a.gender == 'M' %}남성{% elif a.gender == 'F' %}여성{% else %}-{% endif %}
              · {{ a.birth_date|date:"Y.m.d" }}
            </div>
            <div class="text-muted small mt-1">{{ a.email }}</div>
            <div class="text-muted small">{{ a.phone }}</div>
          </div>
        </div>
      </div>
    {% endfor %}
  </div>
{% else %}
  <div class="text-muted">조건에 일치하는 작가가 없습니다.</div>
{% endif %}

{% if is_paginated %}
  <nav aria-label="Page navigation" class="my-4">
    <ul class="pagination justify-content-center pagination-sm">
      {% if page_obj.has_previous %}
        <li class="page-item">
          <a class="page-link text-dark"
             href="?page={{ page_obj.previous_page_number }}{% if preserved_query %}&{{ preserved_query }}{% endif %}">
            이전
          </a>
        </li>
      {% else %}
        <li class="page-item disabled"><span class="page-link text-dark">이전</span></li>
      {% endif %}

      {% for num in page_range %}
        {% if num == page_obj.paginator.ELLIPSIS %}
          <li class="page-item disabled"><span class="page-link text-dark">&hellip;</span></li>
        {% elif num == page_obj.number %}
          <li class="page-item active"><span class="page-link bg-dark border-dark">{{ num }}</span></li>
        {% else %}
          <li class="page-item">
            <a class="page-link text-dark"
               href="?page={{ num }}{% if preserved_query %}&{{ preserved_query }}{% endif %}">{{ num }}</a>
          </li>
        {% endif %}
      {% endfor %}

      {% if page_obj.has_next %}
        <li class="page-item">
          <a class="page-link text-dark"
             href="?page={{ page_obj.next_page_number }}{% if preserved_query %}&{{ preserved_query }}{% endif %}">
            다음
          </a>
        </li>
      {% else %}
        <li class="page-item disabled"><span class="page-link text-dark">다음</span></li>
      {% endif %}
    </ul>
  </nav>
{% endif %}
{% endblock %}